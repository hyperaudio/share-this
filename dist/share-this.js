!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ShareThis=e()}(this,function(){"use strict";function t(t){var e=t.document.body;return("static"===t.getComputedStyle(e).position?e.parentNode:e).getBoundingClientRect()}function e(t,e){return m||(m=r(t)),t[m](e)}function n(t,n){for(var o=t;o&&(1!==o.nodeType||!e(o,n));)o=o.parentNode;return o}function o(t,e){var n=t.compareDocumentPosition(e);return!n||(16&n)>0}function r(t){for(var e="atchesSelector",n=["matches","m"+e,"webkitM"+e,"mozM"+e,"msM"+e,"oM"+e],o=0;o<n.length;o++){var r=n[o];if(t[r])return r}}function i(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.name===e)return o}}function a(t,e){if(e&&"object"===(void 0===e?"undefined":g(e)))for(var n in e)t[n]=e[n];return t}function c(t){return"function"==typeof t}function u(t){return t.startsWith("#")?document.getElementById(t.substring(1,t.length)):null}function f(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function l(t){if(t.isCollapsed)return!0;var e=t.anchorNode.compareDocumentPosition(t.focusNode);return e?(4&e)>0:t.anchorOffset<t.focusOffset}function s(t,e){var n=void 0,o=t.getClientRects(),r=[].slice.bind(o);if(e){for(var i=1/0,a=o.length;a--;){var c=o[a];if(c.left>i)break;i=c.left}n=r(a+1)}else{for(var u=-1/0,l=0;l<o.length;l++){var s=o[l];if(s.right<u)break;u=s.right}n=r(0,l)}return{top:Math.min.apply(Math,f(n.map(function(t){return t.top}))),bottom:Math.max.apply(Math,f(n.map(function(t){return t.bottom}))),left:n[0].left,right:n[n.length-1].right}}function p(t,e){var r=t.cloneRange();if(t.collapsed||!e)return r;var i=n(t.startContainer,e);return i?o(i,t.endContainer)||r.setEnd(i,i.childNodes.length):(i=n(t.endContainer,e),i?r.setStart(i,0):r.collapse()),r}function d(e,n,o){var r=o.document,i=r.defaultView,a=i.getSelection(),c=l(a),f=s(n,c),p=t(i),d=u(o.selector),v=e.style;if(c){var h=f.right+p.left;v.right=r.documentElement.clientWidth-h+"px"}else v.left=f.left-p.left+"px";v.width=f.right-f.left+"px",v.height=f.bottom-f.top+"px",v.top=f.top-p.top+"px";var m=f.top-p.top;if(d){var g=d.scrollTop-d.getBoundingClientRect().top;g+=p.top,v.top=m+g+"px"}else v.top=m+"px";v.position="absolute",e.className=o.popoverClass}function v(t,e){var o=n(e.target,"["+y+"]");if(o){var r=o.getAttribute(y),a=i(t,r);a&&c(a.action)&&a.action(e,o)}}function h(t,e){return{createPopover:function(){var e=t.createElement("div");return e.addEventListener("click",function(t){v(this.sharers,t)}),e},attachPopover:function(n){var o=u(e.selector);o?o.appendChild(n):t.body.appendChild(n)},removePopover:function(t){var e=t.parentNode;e&&e.removeChild(t)}}}var m=void 0,g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y="data-share-via",b=function(t,e,n,o){var r=t.shareUrl||t.document.defaultView.location;return"<ul>"+e.map(function(t){return'<li data-share-via="'+t.name+'">'+t.render.call(t,n,o,r)+"</li>"}).join("")+"</ul>"},C=void 0,S=["selectionchange","mouseup","touchend","touchcancel"];return function(t){function e(t){g.addEventListener(t,r)}function n(t){g.removeEventListener(t,r)}function o(){E&&d(E,i(),s)}function r(t){var e=t.type;!E!=("selectionchange"===e)&&setTimeout(function(){var t=i();t?u(t):f()},10)}function i(){var t=y.getSelection(),e=t.rangeCount&&t.getRangeAt(0);if(e){var n=p(e,s.selector);if(!n.collapsed&&n.getClientRects().length)return n}}function u(t){var e=!E,n=t.toString(),o=s.transformer(n),r=s.sharers.filter(l.bind(null,o,n));if(!r.length)return void(E&&f());e&&(E=x.createPopover()),E.sharers=r,E.innerHTML=b(s,r,o,n),d(E,t,s),e&&(x.attachPopover(E),c(s.onOpen)&&s.onOpen(E,o,n))}function f(){E&&(x.removePopover(E),E=C,c(s.onClose)&&s.onClose())}function l(t,e,n){var o=n.active;return c(o)?o(t,e):o===C||o}var s=(Object.assign||a)({document:document,selector:"body",sharers:[],popoverClass:"share-this-popover",transformer:function(t){return t.trim().replace(/\s+/g," ")}},t||{}),v=!1,m=!1,g=C,y=C,E=C,x=C;return{init:function(){return!v&&(g=s.document,y=g.defaultView,y.getSelection?(S.forEach(e),y.addEventListener("resize",o),x=h(g,s),v=!0):(console.warn("share-this: Selection API isn't supported"),!1))},destroy:function(){return!(!v||m)&&(S.forEach(n),y.removeEventListener("resize",o),f(),g=C,y=C,m=!0)}}}});