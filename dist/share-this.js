!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ShareThis=t()}(this,function(){"use strict";function e(e){var t=e.document.body;return("static"===e.getComputedStyle(t).position?t.parentNode:t).getBoundingClientRect()}function t(e,t){return g||(g=r(e)),e[g](t)}function o(e,o){for(var n=e;n&&(1!==n.nodeType||!t(n,o));)n=n.parentNode;return n}function n(e,t){var o=e.compareDocumentPosition(t);return!o||(16&o)>0}function r(e){for(var t="atchesSelector",o=["matches","m"+t,"webkitM"+t,"mozM"+t,"msM"+t,"oM"+t],n=0;n<o.length;n++){var r=o[n];if(e[r])return r}}function i(e,t){for(var o=0;o<e.length;o++){var n=e[o];if(n.name===t)return n}}function c(e,t){if(t&&"object"===(void 0===t?"undefined":m(t)))for(var o in t)e[o]=t[o];return e}function a(e){return"function"==typeof e}function l(e){return e.startsWith("#")?document.getElementById(e.substring(1,e.length)):null}function u(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}function f(e){if(e.isCollapsed)return!0;var t=e.anchorNode.compareDocumentPosition(e.focusNode);return t?(4&t)>0:e.anchorOffset<e.focusOffset}function s(e,t){var o=void 0,n=e.getClientRects(),r=[].slice.bind(n);if(t){for(var i=1/0,c=n.length;c--;){var a=n[c];if(a.left>i)break;i=a.left}o=r(c+1)}else{for(var l=-1/0,f=0;f<n.length;f++){var s=n[f];if(s.right<l)break;l=s.right}o=r(0,f)}return{top:Math.min.apply(Math,u(o.map(function(e){return e.top}))),bottom:Math.max.apply(Math,u(o.map(function(e){return e.bottom}))),left:o[0].left,right:o[o.length-1].right}}function p(e,t){var r=e.cloneRange();if(e.collapsed||!t)return r;var i=o(e.startContainer,t);return i?n(i,e.endContainer)||r.setEnd(i,i.childNodes.length):(i=o(e.endContainer,t),i?r.setStart(i,0):r.collapse()),r}function d(t,o,n){var r=n.document,i=r.defaultView,c=i.getSelection(),a=f(c),u=s(o,a),p=e(i),d=l(n.selector),v=t.style;if(a){var h=u.right+p.left;v.right=r.documentElement.clientWidth-h+"px"}else v.left=u.left-p.left+"px";v.width=u.right-u.left+"px",v.height=u.bottom-u.top+"px",v.top=u.top-p.top+"px";var g=u.top-p.top;if(d){var m=d.scrollTop-d.getBoundingClientRect().top;console.log("  selectorElement.scrollTop = "+d.scrollTop),console.log("- selectorElement.getBoundingClientRect().top = "+d.getBoundingClientRect().top),console.log("========================="),console.log("  offset = "+m),console.log("========================="),m+=p.top,console.log("offsetScroll.top = "+p.top),console.log("offset += offsetScroll.top = "+m),console.log("========================="),v.top=g+m+"px",console.log("style.top = `startTop + offset px` = "+v.top)}else v.top=g+"px";v.position="absolute",t.className=n.popoverClass}function v(e,t){var n=o(t.target,"["+y+"]");if(n){var r=n.getAttribute(y),c=i(e,r);c&&a(c.action)&&c.action(t,n)}}function h(e,t){return{createPopover:function(){var t=e.createElement("div");return t.addEventListener("click",function(e){v(this.sharers,e)}),t},attachPopover:function(o){var n=l(t.selector);n?n.appendChild(o):e.body.appendChild(o)},removePopover:function(e){var t=e.parentNode;t&&t.removeChild(e)}}}var g=void 0,m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y="data-share-via",b=function(e,t,o,n){var r=e.shareUrl||e.document.defaultView.location;return"<ul>"+t.map(function(e){return'<li data-share-via="'+e.name+'">'+e.render.call(e,o,n,r)+"</li>"}).join("")+"</ul>"},C=void 0,S=["selectionchange","mouseup","touchend","touchcancel"];return function(e){function t(e){m.addEventListener(e,r)}function o(e){m.removeEventListener(e,r)}function n(){E&&d(E,i(),s)}function r(e){var t=e.type;!E!=("selectionchange"===t)&&setTimeout(function(){var e=i();e?l(e):u()},10)}function i(){var e=y.getSelection(),t=e.rangeCount&&e.getRangeAt(0);if(t){var o=p(t,s.selector);if(!o.collapsed&&o.getClientRects().length)return o}}function l(e){var t=!E,o=e.toString(),n=s.transformer(o),r=s.sharers.filter(f.bind(null,n,o));if(!r.length)return void(E&&u());t&&(E=x.createPopover()),E.sharers=r,E.innerHTML=b(s,r,n,o),d(E,e,s),t&&(x.attachPopover(E),a(s.onOpen)&&s.onOpen(E,n,o))}function u(){E&&(x.removePopover(E),E=C,a(s.onClose)&&s.onClose())}function f(e,t,o){var n=o.active;return a(n)?n(e,t):n===C||n}var s=(Object.assign||c)({document:document,selector:"body",sharers:[],popoverClass:"share-this-popover",transformer:function(e){return e.trim().replace(/\s+/g," ")}},e||{}),v=!1,g=!1,m=C,y=C,E=C,x=C;return{init:function(){return!v&&(m=s.document,y=m.defaultView,y.getSelection?(S.forEach(t),y.addEventListener("resize",n),x=h(m,s),v=!0):(console.warn("share-this: Selection API isn't supported"),!1))},destroy:function(){return!(!v||g)&&(S.forEach(o),y.removeEventListener("resize",n),u(),m=C,y=C,g=!0)}}}});